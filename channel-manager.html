<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Channel Manager - NUA STUDIO</title>
  
  <!-- Î≥¥Ïïà: Ï¶âÏãú ÌÜ†ÌÅ∞ Í≤ÄÏ¶ù -->
  <script>
    (function() {
      const token = localStorage.getItem('adminToken');
      const role = localStorage.getItem('adminRole');
      
      // ÌÜ†ÌÅ∞Ïù¥ ÏóÜÍ±∞ÎÇò system_admin Ïó≠Ìï†Ïù¥ ÏïÑÎãàÎ©¥ Ï¶âÏãú Î¶¨Îã§Ïù¥Î†âÌä∏
      // ‚ö†Ô∏è Ï§ëÏöî: Î∞±ÏóîÎìúÏùò Ïó≠Ìï† Î¨∏ÏûêÏó¥Í≥º Ï†ïÌôïÌûà ÏùºÏπòÌï¥Ïïº Ìï®
      // ÏòàÏãú: 'system_admin', 'admin', 'super', 'owner' Îì±
      // Ïã§Ï†ú Î∞±ÏóîÎìúÏóêÏÑú ÏÇ¨Ïö©ÌïòÎäî Í∞íÏúºÎ°ú Î≥ÄÍ≤Ω ÌïÑÏöî
      const REQUIRED_ROLE = 'system_admin';  // TODO: Ïã§Ï†ú Î∞±ÏóîÎìú Ïó≠Ìï† Î¨∏ÏûêÏó¥Î°ú Î≥ÄÍ≤Ω
      
      if (!token || role !== REQUIRED_ROLE) {
        window.location.replace('index.html');
        return;
      }
    })();
  </script>
  
  <!-- Î≥ÄÍ≤Ω: Contact/AboutÍ≥º ÎèôÏùºÌïú Ìè∞Ìä∏ Ï∂îÍ∞Ä -->
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Poppins:100,100italic,200,200italic,300,300italic,regular,italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:300,300italic,regular,italic,500,500italic,700,700italic" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css">
  
  <!-- Î≥ÄÍ≤Ω: GSAP Ï∂îÍ∞Ä (About/Contact Ïï†ÎãàÎ©îÏù¥ÏÖòÏö©) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    :root {
      --black: #000000;
      --white: #ffffff;
      --gray: #666666;
      --light-gray: #f5f5f5;
      --neon-blue: #00f0ff;
      --neon-purple: #a259ff;
      --accent-gradient: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
      --ease: cubic-bezier(0.19, 1, 0.22, 1);
    }
    
    /* Î≥ÄÍ≤Ω: About/Contact Ïä§ÌÉÄÏùº Ï†ÅÏö© */
    body {
      background: #fff;
      color: #000;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      line-height: 1;
    }
    
    /* Scroll styles */
    html::-webkit-scrollbar {width: 8px;}
    html::-webkit-scrollbar-thumb {background-color: #2f3542; border-radius: 10px;}
    
    /* General wrapper styles */
    .wrap {margin: 0 auto; width: 95%;}
    .wrap[max='1708'] {max-width: 1708px;}
    .wrap[max='1440'] {max-width: 1440px;}
    
    /* Header - About/Contact Ïä§ÌÉÄÏùº Ï†ÅÏö© */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: transparent;
      z-index: 1000;
      padding: 2rem 0;
      transition: all 0.3s ease;
    }
    
    .header.scrolled {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 20px rgba(0,0,0,0.05);
      padding: 1rem 0;
    }
    
    .header .wrap {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .header .logo {
      width: 122px;
      flex-shrink: 0;
      position: relative;
      z-index: 101;
    }
    
    .header .logo svg {
      width: 100%;
      height: auto;
    }
    
    .header .logo svg path {
      fill: #000;
    }
    
    .header .logo svg text {
      fill: #fff;
    }
    
    .header .menu {
      font-size: 20px;
      display: flex;
      align-items: center;
    }
    
    .header .menu ul {
      display: flex;
      align-items: center;
      gap: 3rem;
      list-style: none;
    }
    
    .header .menu li {
      font-size: inherit;
      font-weight: 700;
      letter-spacing: 0.025em;
      font-family: 'Ubuntu', sans-serif;
      position: relative;
      transition: .4s;
      color: #000;
    }
    
    .header .menu li.active {
      color: var(--neon-blue);
    }
    
    .header .menu li a {
      position: relative;
      z-index: 1;
      padding: 5px;
      color: inherit;
      text-decoration: none;
    }
    
    .header .menu li::before {
      content: '';
      z-index: -1;
      position: absolute;
      top: 0;
      left: 0;
      display: block;
      width: 0%;
      height: 100%;
      background: var(--neon-blue);
      transition: .4s;
    }
    
    .header .menu li:hover::before {
      width: 100%;
    }
    
    /* Î≥ÄÍ≤Ω: Hero Section Ï∂îÍ∞Ä (About/Contact Ïä§ÌÉÄÏùº) */
    .cm-hero {
      position: relative;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: #000;
    }
    
    .cm-hero-title {
      position: relative;
      z-index: 2;
      text-align: center;
      opacity: 0;
      transform: translateY(30px);
    }
    
    .cm-hero-title h1 {
      font-family: 'Poppins', sans-serif;
      font-size: clamp(80px, 10vw, 160px);
      font-weight: 700;
      letter-spacing: -0.02em;
      color: transparent;
      -webkit-text-stroke: 2px var(--neon-blue);
      margin-bottom: 2rem;
      position: relative;
      display: inline-block;
    }
    
    .cm-hero-title h1::after {
      content: 'CHANNEL';
      position: absolute;
      left: 10px;
      top: 10px;
      z-index: -1;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      -webkit-text-stroke: 0;
    }
    
    .cm-hero-subtitle {
      font-family: 'Poppins', sans-serif;
      font-size: 1.5rem;
      color: #fff;
      opacity: 0.8;
      margin-bottom: 1rem;
    }
    
    .cm-hero-desc {
      font-family: 'Pretendard', sans-serif;
      font-size: 1.1rem;
      color: #fff;
      opacity: 0.6;
    }
    
    /* Î≥ÄÍ≤Ω: Floating objects (About/Contact Ïä§ÌÉÄÏùº) */
    .cm-objects {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      filter: url(#gooey);
      opacity: 0;
    }
    
    .cm-obj {
      position: absolute;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
      opacity: 0.3;
    }
    
    .cm-obj:nth-child(1) {
      width: 200px;
      height: 200px;
      top: 10%;
      left: 10%;
      animation: float1 8s ease-in-out infinite;
    }
    
    .cm-obj:nth-child(2) {
      width: 150px;
      height: 150px;
      top: 60%;
      right: 15%;
      animation: float2 10s ease-in-out infinite;
    }
    
    .cm-obj:nth-child(3) {
      width: 100px;
      height: 100px;
      bottom: 20%;
      left: 30%;
      animation: float3 6s ease-in-out infinite;
    }
    
    @keyframes float1 {
      0%, 100% { transform: translate(0, 0) scale(1); }
      50% { transform: translate(30px, -50px) scale(0.9); }
    }
    
    @keyframes float2 {
      0%, 100% { transform: translate(0, 0) scale(1); }
      50% { transform: translate(-40px, 30px) scale(1.1); }
    }
    
    @keyframes float3 {
      0%, 100% { transform: translate(0, 0) scale(1); }
      50% { transform: translate(20px, -30px) scale(0.95); }
    }
    
    /* Container Ï°∞Ï†ï */
    .container {
      max-width: 1440px;
      margin: 0 auto;
      padding: 2rem;
      position: relative;
      z-index: 1;
    }
    
    /* Î≥ÄÍ≤Ω: Section Title (About/Contact Ïä§ÌÉÄÏùº) */
    .cm-section-title {
      text-align: center;
      margin: 6rem 0 4rem;
      opacity: 0;
      transform: translateY(30px);
    }
    
    .cm-section-title span {
      font-family: 'Poppins', sans-serif;
      font-size: 1rem;
      font-weight: 500;
      color: var(--neon-blue);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      display: block;
      margin-bottom: 1rem;
    }
    
    .cm-section-title h2 {
      font-family: 'Poppins', sans-serif;
      font-size: 3rem;
      font-weight: 700;
      color: #000;
      letter-spacing: -0.02em;
      position: relative;
      display: inline-block;
    }
    
    .cm-section-title h2 b {
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    /* Stats Dashboard - Î¶¨ÎîîÏûêÏù∏ */
    .stats-dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin: 4rem 0;
    }
    
    .stat-card {
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border: 2px solid transparent;
      background-clip: padding-box;
      border-radius: 20px;
      padding: 2rem;
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      opacity: 0;
      transform: translateY(30px);
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--accent-gradient);
      border-radius: 20px;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: -1;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 40px rgba(0, 240, 255, 0.2);
      border-color: var(--neon-blue);
    }
    
    .stat-card:hover::before {
      opacity: 0.05;
    }
    
    .stat-number {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.5rem;
      font-family: 'Poppins', sans-serif;
    }
    
    .stat-label {
      font-size: 0.9rem;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-family: 'Pretendard', sans-serif;
      font-weight: 500;
    }
    
    /* Create Channel Section - Î¶¨ÎîîÏûêÏù∏ */
    .create-section {
      background: linear-gradient(135deg, #000 0%, #1a1a1a 100%);
      border: 2px solid transparent;
      background-clip: padding-box;
      border-radius: 30px;
      padding: 3rem;
      margin: 4rem 0;
      position: relative;
      overflow: hidden;
      opacity: 0;
      transform: translateY(30px);
    }
    
    .create-section::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: var(--accent-gradient);
      border-radius: 30px;
      z-index: -1;
    }
    
    .section-title {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 2rem;
      color: #fff;
      display: flex;
      align-items: center;
      gap: 1rem;
      font-family: 'Poppins', sans-serif;
      letter-spacing: -0.02em;
    }
    
    .create-form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }
    
    .form-label {
      font-size: 0.9rem;
      color: var(--neon-blue);
      font-family: 'Poppins', sans-serif;
      font-weight: 500;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    
    input[type="text"], input[type="number"], input[type="datetime-local"], select {
      padding: 1rem 1.2rem;
      border-radius: 12px;
      border: 2px solid rgba(255,255,255,0.1);
      background: rgba(255,255,255,0.05);
      color: #fff;
      font-family: 'Pretendard', sans-serif;
      font-size: 1rem;
      letter-spacing: 0.02em;
      transition: all 0.3s ease;
      width: 100%;
      height: 50px;
    }
    
    input:focus, select:focus {
      outline: none;
      border-color: var(--neon-blue);
      background: rgba(0, 240, 255, 0.05);
      box-shadow: 0 0 20px rgba(0, 240, 255, 0.1);
    }
    
    input::placeholder {
      color: rgba(255,255,255,0.3);
    }
    
    /* Quick Actions - Î¶¨ÎîîÏûêÏù∏ */
    .quick-actions {
      display: flex;
      gap: 1.5rem;
      margin: 2rem 0;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .quick-btn {
      padding: 1.2rem 2rem;
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border: 2px solid #e0e0e0;
      border-radius: 15px;
      color: #000;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      font-family: 'Pretendard', sans-serif;
      font-weight: 600;
      position: relative;
      overflow: hidden;
    }
    
    .quick-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 100%;
      background: var(--accent-gradient);
      transition: width 0.4s ease;
      z-index: -1;
    }
    
    .quick-btn:hover {
      color: #fff;
      border-color: var(--neon-blue);
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 240, 255, 0.3);
    }
    
    .quick-btn:hover::before {
      width: 100%;
    }
    
    /* Channel Type Radio - Î¶¨ÎîîÏûêÏù∏ */
    .channel-types {
      display: flex;
      gap: 1rem;
    }
    
    .type-option {
      flex: 1;
      position: relative;
    }
    
    .type-option input[type="radio"] {
      position: absolute;
      opacity: 0;
    }
    
    .type-label {
      display: block;
      padding: 1rem;
      background: rgba(255,255,255,0.05);
      border: 2px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: rgba(255,255,255,0.6);
      font-family: 'Pretendard', sans-serif;
      font-weight: 500;
    }
    
    .type-label:hover {
      background: rgba(0, 240, 255, 0.1);
      border-color: var(--neon-blue);
      color: #fff;
    }
    
    .type-option input[type="radio"]:checked + .type-label {
      background: var(--accent-gradient);
      border-color: transparent;
      color: #fff;
      font-weight: 600;
    }
    
    .passkey-group {
      display: flex;
      gap: 0.8rem;
      align-items: flex-end;
    }
    
    .passkey-group input {
      flex: 1;
    }
    
    .dice-button {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 12px;
      padding: 0;
      cursor: pointer;
      color: #fff;
      font-size: 1.5rem;
      transition: all 0.3s ease;
      height: 50px;
      width: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .dice-button:hover {
      color: var(--neon-blue);
      background: rgba(0, 240, 255, 0.1);
      border-color: var(--neon-blue);
      transform: rotate(180deg) scale(1.1);
    }
    
    .btn-primary {
      background: var(--accent-gradient);
      color: #fff;
      padding: 1rem 3rem;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      letter-spacing: 0.02em;
      position: relative;
      overflow: hidden;
    }
    
    .btn-primary::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 40px rgba(0, 240, 255, 0.4);
    }
    
    .btn-primary:hover::before {
      width: 300px;
      height: 300px;
    }
    
    /* Channel List Table - Î¶¨ÎîîÏûêÏù∏ */
    .channel-list {
      background: #fff;
      border: 2px solid #f0f0f0;
      border-radius: 30px;
      overflow: hidden;
      margin: 4rem 0;
      box-shadow: 0 10px 40px rgba(0,0,0,0.05);
      opacity: 0;
      transform: translateY(30px);
    }
    
    .list-header {
      padding: 2rem;
      border-bottom: 2px solid #f0f0f0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(135deg, #fafafa 0%, #ffffff 100%);
    }
    
    .search-box {
      display: flex;
      gap: 1rem;
      align-items: center;
    }
    
    .search-box input {
      width: 300px;
      padding: 0.8rem 1.2rem;
      font-size: 0.95rem;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      transition: all 0.3s ease;
      font-family: 'Pretendard', sans-serif;
    }
    
    .search-box input:focus {
      border-color: var(--neon-blue);
      box-shadow: 0 0 20px rgba(0, 240, 255, 0.1);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    thead {
      background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
      border-bottom: 2px solid #f0f0f0;
    }
    
    th {
      padding: 1.5rem 1rem;
      text-align: left;
      font-size: 0.85rem;
      color: #666;
      font-weight: 700;
      letter-spacing: 0.1em;
      font-family: 'Poppins', sans-serif;
      text-transform: uppercase;
    }
    
    td {
      padding: 1.2rem 1rem;
      border-bottom: 1px solid #f0f0f0;
      font-size: 0.95rem;
      font-family: 'Pretendard', sans-serif;
    }
    
    tbody tr {
      transition: all 0.3s ease;
      background: #fff;
    }
    
    tbody tr:hover {
      background: linear-gradient(135deg, rgba(0,240,255,0.03) 0%, rgba(162,89,255,0.03) 100%);
      transform: translateX(5px);
    }
    
    .channel-code {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      color: #000;
      letter-spacing: 0.05em;
      cursor: pointer;
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }
    
    .channel-code:hover {
      color: var(--neon-blue);
    }
    
    .badge {
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      display: inline-block;
      font-family: 'Poppins', sans-serif;
      letter-spacing: 0.05em;
    }
    
    .badge.public {
      background: linear-gradient(135deg, #4ecdc4, #44a3aa);
      color: #fff;
      border: none;
    }
    
    .badge.secured {
      background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
      color: #fff;
      border: none;
    }
    
    .passkey {
      font-family: 'Poppins', sans-serif;
      background: #f5f5f5;
      padding: 0.3rem 0.6rem;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      font-weight: 600;
      letter-spacing: 0.1em;
    }
    
    .active-count {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .count-dot {
      width: 10px;
      height: 10px;
      background: #4ecdc4;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.2); }
      100% { opacity: 1; transform: scale(1); }
    }
    
    .actions {
      display: flex;
      gap: 0.5rem;
    }
    
    .btn-small {
      padding: 0.5rem 1rem;
      border: 2px solid #e0e0e0;
      background: #fff;
      color: #666;
      border-radius: 8px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Pretendard', sans-serif;
      font-weight: 600;
    }
    
    .btn-small:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .btn-small.manage {
      border-color: var(--neon-blue);
      color: var(--neon-blue);
    }
    
    .btn-small.manage:hover {
      background: var(--neon-blue);
      color: #fff;
    }
    
    .btn-small.copy {
      border-color: #4ecdc4;
      color: #4ecdc4;
    }
    
    .btn-small.copy:hover {
      background: #4ecdc4;
      color: #fff;
    }
    
    .btn-small.delete {
      border-color: #e06c75;
      color: #e06c75;
    }
    
    .btn-small.delete:hover {
      background: #e06c75;
      color: #fff;
    }
    
    /* Modal - Î¶¨ÎîîÏûêÏù∏ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .modal.show {
      display: flex;
    }
    
    .modal-content {
      background: #fff;
      border: 2px solid var(--neon-blue);
      border-radius: 30px;
      padding: 2.5rem;
      max-width: 650px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }
    
    .modal-content::before {
      content: '';
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      background: var(--accent-gradient);
      border-radius: 30px;
      z-index: -1;
      opacity: 0.3;
      filter: blur(20px);
    }
    
    .modal-header {
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .modal-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: #000;
      font-family: 'Poppins', sans-serif;
      letter-spacing: -0.02em;
    }
    
    .modal-title span {
      color: var(--neon-blue);
    }
    
    .modal-section {
      margin-bottom: 2rem;
    }
    
    .modal-section h4 {
      color: var(--neon-purple);
      font-size: 0.9rem;
      margin-bottom: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
    }
    
    .url-group {
      display: flex;
      gap: 0.8rem;
      margin-bottom: 1rem;
    }
    
    .url-input {
      flex: 1;
      padding: 0.8rem;
      background: #f5f5f5;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      color: #666;
      font-family: 'Pretendard', sans-serif;
      font-size: 0.9rem;
    }
    
    .copy-btn {
      padding: 0.8rem 1.5rem;
      background: var(--accent-gradient);
      border: none;
      border-radius: 10px;
      color: #fff;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Pretendard', sans-serif;
      font-weight: 600;
    }
    
    .copy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(0, 240, 255, 0.3);
    }
    
    .type-toggle {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .type-toggle-btn {
      flex: 1;
      padding: 1rem;
      background: #f5f5f5;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      color: #666;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      font-family: 'Pretendard', sans-serif;
      font-weight: 600;
    }
    
    .type-toggle-btn.active {
      background: var(--accent-gradient);
      color: #fff;
      border-color: transparent;
    }
    
    .type-toggle-btn:hover:not(.active) {
      background: #fff;
      border-color: var(--neon-blue);
      color: var(--neon-blue);
    }
    
    .status-info {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border-radius: 15px;
      border: 2px solid #f0f0f0;
    }
    
    .status-item {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .status-label {
      font-size: 0.8rem;
      color: #888;
      font-family: 'Poppins', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .status-value {
      font-size: 1.3rem;
      color: #000;
      font-weight: 700;
      font-family: 'Poppins', sans-serif;
    }
    
    .modal-footer {
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 2px solid #f0f0f0;
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
    }
    
    /* Footer - Î¶¨ÎîîÏûêÏù∏ */
    footer {
      background: #000;
      text-align: center;
      padding: 3rem;
      font-size: 0.9rem;
      color: #666;
      margin-top: 6rem;
      font-family: 'Pretendard', sans-serif;
      position: relative;
    }
    
    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--accent-gradient);
    }
    
    /* Loading */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #e0e0e0;
      border-radius: 50%;
      border-top-color: var(--neon-blue);
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Toast Notification - Î¶¨ÎîîÏûêÏù∏ */
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: #fff;
      border: 2px solid var(--neon-blue);
      border-radius: 15px;
      padding: 1.2rem 2rem;
      color: #000;
      z-index: 3000;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s ease;
      font-family: 'Pretendard', sans-serif;
      font-weight: 600;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .toast.success {
      border-color: #4ecdc4;
      background: linear-gradient(135deg, #e8fffe 0%, #ffffff 100%);
    }
    
    .toast.error {
      border-color: #e06c75;
      background: linear-gradient(135deg, #ffe8e8 0%, #ffffff 100%);
    }
    
    /* SVG Filter for Gooey effect */
    svg {
      display: none;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }
      
      .header .menu ul {
        gap: 1rem;
        font-size: 16px;
      }
      
      .create-form {
        grid-template-columns: 1fr;
      }
      
      .search-box input {
        width: 150px;
      }
      
      table {
        font-size: 0.8rem;
      }
      
      th, td {
        padding: 0.8rem 0.5rem;
      }
      
      .actions {
        flex-direction: column;
      }
      
      .stats-dashboard {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .cm-hero-title h1 {
        font-size: clamp(60px, 8vw, 100px);
      }
    }
    
    @media (max-width: 480px) {
      .stats-dashboard {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- SVG Filter for Gooey Effect -->
  <svg>
    <filter id="gooey">
      <feGaussianBlur in="SourceGraphic" stdDeviation="10" />
      <feColorMatrix values="
        1 0 0 0 0
        0 1 0 0 0
        0 0 1 0 0
        0 0 0 20 -10" />
    </filter>
  </svg>

  <!-- Header - Íµ¨Ï°∞ Ïú†ÏßÄ, Ïä§ÌÉÄÏùºÎßå Î≥ÄÍ≤Ω -->
  <header class="header" id="header">
    <div class="wrap" max="1708">
      <div class="logo">
        <a href="index.html">
          <svg viewBox="0 0 122 50" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M0 25C0 11.193 11.193 0 25 0h72c13.807 0 25 11.193 25 25s-11.193 25-25 25H25C11.193 50 0 38.807 0 25z" fill="#000"/>
            <text x="61" y="32" text-anchor="middle" fill="white" font-family="Poppins" font-size="20" font-weight="700">NUA</text>
          </svg>
        </a>
      </div>
      <div class="menu">
        <ul>
          <li><a href="index.html">HOME</a></li>
          <li class="active"><a href="#">ADMIN</a></li>
          <li><a href="#" onclick="showStats()">STATS</a></li>
          <li><a href="#" onclick="logout()">LOGOUT</a></li>
        </ul>
      </div>
    </div>
  </header>

  <!-- Î≥ÄÍ≤Ω: Hero Section Ï∂îÍ∞Ä -->
  <section class="cm-hero">
    <div class="cm-objects">
      <div class="cm-obj"></div>
      <div class="cm-obj"></div>
      <div class="cm-obj"></div>
    </div>
    
    <div class="cm-hero-title">
      <h1>CHANNEL</h1>
      <p class="cm-hero-subtitle">Real-time Caption Management</p>
      <p class="cm-hero-desc">NUA STUDIO</p>
    </div>
  </section>

  <div class="container">
    <!-- Î≥ÄÍ≤Ω: Section Title Ï∂îÍ∞Ä -->
    <div class="cm-section-title">
      <span>Dashboard</span>
      <h2>Channel <b>Statistics</b></h2>
    </div>

    <!-- Statistics Dashboard - Íµ¨Ï°∞ Ïú†ÏßÄ, Ïä§ÌÉÄÏùºÎßå Î≥ÄÍ≤Ω -->
    <div class="stats-dashboard">
      <div class="stat-card">
        <div class="stat-number" id="totalChannels">0</div>
        <div class="stat-label">ÌôúÏÑ± Ï±ÑÎÑê</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="totalUsers">0</div>
        <div class="stat-label">Ï†ÑÏ≤¥ ÏÇ¨Ïö©Ïûê</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="todayChannels">0</div>
        <div class="stat-label">Ïò§Îäò ÏÉùÏÑ±</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="avgDuration">0</div>
        <div class="stat-label">ÌèâÍ∑† ÏÇ¨Ïö©ÏãúÍ∞Ñ(Î∂Ñ)</div>
      </div>
    </div>

    <!-- Quick Actions - Íµ¨Ï°∞ Ïú†ÏßÄ -->
    <div class="quick-actions">
      <button class="quick-btn" onclick="exportAllData()">
        üìä Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞
      </button>
      <button class="quick-btn" onclick="exportAllSubtitles()">
        üìù Ï†ÑÏ≤¥ ÏûêÎßâ ÎÇ¥Î≥¥ÎÇ¥Í∏∞
      </button>
    </div>

    <!-- Î≥ÄÍ≤Ω: Section Title Ï∂îÍ∞Ä -->
    <div class="cm-section-title">
      <span>Create</span>
      <h2>New <b>Channel</b></h2>
    </div>

    <!-- Create New Channel - Íµ¨Ï°∞ Ïú†ÏßÄ -->
    <div class="create-section">
      <h2 class="section-title">üì° Create New Channel</h2>
      <form class="create-form" onsubmit="createChannel(event)">
        <div class="form-group">
          <label class="form-label">CHANNEL CODE</label>
          <div class="passkey-group">
            <input type="text" id="newChannelCode" placeholder="ABCD12" maxlength="6" required />
            <button type="button" class="dice-button" onclick="generateChannelCode()" title="Generate random code">üé≤</button>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">CHANNEL TYPE</label>
          <div class="channel-types">
            <div class="type-option">
              <input type="radio" id="typePublic" name="channelType" value="public" />
              <label class="type-label" for="typePublic">üåê Í≥µÍ∞ú</label>
            </div>
            <div class="type-option">
              <input type="radio" id="typeSecured" name="channelType" value="secured" checked />
              <label class="type-label" for="typeSecured">üîí ÎπÑÍ≥µÍ∞ú</label>
            </div>
          </div>
        </div>

        <div class="form-group" id="passkeyField">
          <label class="form-label">PASSKEY (4 DIGITS)</label>
          <div class="passkey-group">
            <input type="text" id="newPasskey" placeholder="1234" maxlength="4" pattern="[0-9]{4}" />
            <button type="button" class="dice-button" onclick="generatePasskey()" title="Generate random passkey">üîê</button>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">EVENT NAME</label>
          <input type="text" id="eventName" placeholder="Ïòà: 2025 Ïã†ÎÖÑ ÏÑ∏ÎØ∏ÎÇò" />
        </div>

        <div class="form-group">
          <label class="form-label">EVENT DATE & TIME</label>
          <input type="datetime-local" id="eventDateTime" />
        </div>

        <div class="form-group">
          <label class="form-label">AUTO CLOSE</label>
          <div style="display: flex; gap: 0.5rem;">
            <select id="autoCloseType" onchange="toggleAutoCloseInput()" style="flex: 1;">
              <option value="none">ÏûêÎèô Ï¢ÖÎ£å ÏïàÌï®</option>
              <option value="hours" selected>ÏãúÍ∞Ñ ÌõÑ Ï¢ÖÎ£å</option>
              <option value="datetime">ÌäπÏ†ï ÏãúÍ∞Ñ Ï¢ÖÎ£å</option>
            </select>
            <select id="autoCloseHours" style="flex: 1;">
              <option value="1">1ÏãúÍ∞Ñ ÌõÑ</option>
              <option value="2" selected>2ÏãúÍ∞Ñ ÌõÑ</option>
              <option value="3">3ÏãúÍ∞Ñ ÌõÑ</option>
              <option value="4">4ÏãúÍ∞Ñ ÌõÑ</option>
              <option value="6">6ÏãúÍ∞Ñ ÌõÑ</option>
              <option value="12">12ÏãúÍ∞Ñ ÌõÑ</option>
              <option value="24">24ÏãúÍ∞Ñ ÌõÑ</option>
            </select>
            <input type="datetime-local" id="autoCloseDateTime" style="flex: 1; display: none;" />
          </div>
        </div>

        <div class="form-group">
          <button type="submit" class="btn-primary" id="createBtn">CREATE CHANNEL</button>
        </div>
      </form>
    </div>

    <!-- Î≥ÄÍ≤Ω: Section Title Ï∂îÍ∞Ä -->
    <div class="cm-section-title">
      <span>Manage</span>
      <h2>Active <b>Channels</b></h2>
    </div>

    <!-- Channel List - Íµ¨Ï°∞ Ïú†ÏßÄ -->
    <div class="channel-list">
      <div class="list-header">
        <h2 class="section-title">üìã Active Channels</h2>
        <div class="search-box">
          <input type="text" placeholder="Search channels..." onkeyup="searchChannels(this.value)" />
          <button class="btn-small" onclick="searchChannels(document.querySelector('.search-box input').value)">Search</button>
        </div>
      </div>
      
      <table>
        <thead>
          <tr>
            <th>CHANNEL</th>
            <th>TYPE</th>
            <th>PASSKEY</th>
            <th>USERS</th>
            <th>STATUS</th>
            <th>CREATED</th>
            <th style="width: 300px;">ACTIONS</th>
          </tr>
        </thead>
        <tbody id="channelTableBody">
          <tr>
            <td colspan="7" style="text-align: center; padding: 2rem;">
              <div class="loading"></div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Channel Management Modal - Íµ¨Ï°∞ Ïú†ÏßÄ -->
  <div class="modal" id="channelModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Ï±ÑÎÑê Í¥ÄÎ¶¨: <span id="modalChannelCode"></span></h3>
      </div>
      
      <div class="modal-section">
        <h4>Ï†ëÏÜç URL</h4>
        <div class="url-group">
          <input type="text" class="url-input" id="viewerURL" readonly>
          <button class="copy-btn" onclick="copyURL('viewerURL')">Î≥µÏÇ¨</button>
        </div>
        <div class="url-group">
          <input type="text" class="url-input" id="stenoURL" readonly>
          <button class="copy-btn" onclick="copyURL('stenoURL')">Î≥µÏÇ¨</button>
        </div>
      </div>
      
      <div class="modal-section">
        <h4>Ï±ÑÎÑê ÏÉÅÌÉú</h4>
        <div class="status-info">
          <div class="status-item">
            <span class="status-label">ÌòÑÏû¨ Ï†ëÏÜçÏûê</span>
            <span class="status-value" id="modalViewers">0Î™Ö</span>
          </div>
          <div class="status-item">
            <span class="status-label">ÏÉùÏÑ± ÏãúÍ∞Ñ</span>
            <span class="status-value" id="modalCreated">-</span>
          </div>
          <div class="status-item">
            <span class="status-label">Í≤ΩÍ≥º ÏãúÍ∞Ñ</span>
            <span class="status-value" id="modalDuration">0Î∂Ñ</span>
          </div>
          <div class="status-item">
            <span class="status-label">ÏûêÎèô Ï¢ÖÎ£å</span>
            <span class="status-value" id="modalAutoClose">-</span>
          </div>
        </div>
      </div>
      
      <div class="modal-section">
        <h4>Ï±ÑÎÑê ÌÉÄÏûÖ Î≥ÄÍ≤Ω</h4>
        <div class="type-toggle">
          <button class="type-toggle-btn" id="publicToggle" onclick="changeChannelType('public')">
            üåê Í≥µÍ∞úÎ°ú Î≥ÄÍ≤Ω
          </button>
          <button class="type-toggle-btn" id="securedToggle" onclick="changeChannelType('secured')">
            üîí ÎπÑÍ≥µÍ∞úÎ°ú Î≥ÄÍ≤Ω
          </button>
        </div>
      </div>
      
      <div class="modal-section" id="passkeySection">
        <h4>Ìå®Ïä§ÌÇ§ Î≥ÄÍ≤Ω</h4>
        <div class="url-group">
          <input type="text" id="modalNewPasskey" placeholder="ÏÉà Ìå®Ïä§ÌÇ§ (4ÏûêÎ¶¨)" maxlength="4">
          <button class="copy-btn" onclick="updatePasskey()">Î≥ÄÍ≤Ω</button>
        </div>
      </div>
      
      <div class="modal-section">
        <h4>Ï±ÑÎÑê Ïó∞Ïû•</h4>
        <div class="quick-actions">
          <button class="quick-btn" onclick="extendChannel(1)">+1ÏãúÍ∞Ñ</button>
          <button class="quick-btn" onclick="extendChannel(2)">+2ÏãúÍ∞Ñ</button>
          <button class="quick-btn" onclick="extendChannel(3)">+3ÏãúÍ∞Ñ</button>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn-primary" onclick="exportChannelData()">Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
        <button class="btn-small delete" onclick="deleteChannelFromModal()">Ï±ÑÎÑê ÏÇ≠Ï†ú</button>
        <button class="btn-small" onclick="closeModal()">Îã´Í∏∞</button>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast"></div>

  <footer>
    &copy; 2025 NUA STUDIO ¬∑ Channel Management System
  </footer>

  <script src="config.js"></script>
  <script>
    // API Base URL - REST API Ïö∞ÏÑ†, SOCKET_URLÏùÄ Î∞±ÏóÖ
    const API_BASE_URL = 
      (window.CONFIG && (window.CONFIG.API_BASE_URL || window.CONFIG.REST_URL)) ||
      (window.CONFIG && window.CONFIG.SOCKET_URL) || // Î∞±ÏóÖ
      'http://localhost:3000';
    
    let currentModalChannel = null;
    let channels = [];
    
    // Ïù∏Ï¶ù Ìó§Îçî Í≥µÌÜµ Ìï®Ïàò
    function authHeaders(extra = {}) {
      const token = localStorage.getItem('adminToken');
      return {
        'Content-Type': 'application/json',
        'Authorization': token || '',
        'ngrok-skip-browser-warning': 'true',
        ...extra
      };
    }
    
    // Auth check - Î≥¥Ïïà Í∞ïÌôî: ÌÜ†ÌÅ∞Í≥º Ïó≠Ìï† Ïû¨ÌôïÏù∏
    const REQUIRED_ROLE = 'system_admin';  // TODO: Ïã§Ï†ú Î∞±ÏóîÎìú Ïó≠Ìï† Î¨∏ÏûêÏó¥Î°ú Î≥ÄÍ≤Ω
    
    window.addEventListener('DOMContentLoaded', () => {
      const token = localStorage.getItem('adminToken');
      const role = localStorage.getItem('adminRole');
      
      // ÌÜ†ÌÅ∞Ïù¥ ÏóÜÍ±∞ÎÇò ÌïÑÏöîÌïú Ïó≠Ìï†Ïù¥ ÏïÑÎãàÎ©¥ Î¶¨Îã§Ïù¥Î†âÌä∏
      if (!token || role !== REQUIRED_ROLE) {
        alert('Í¥ÄÎ¶¨Ïûê Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
        window.location.href = 'index.html';
        return;
      }
      
      // Load initial data
      loadChannelList();
      updateStats();
      
      // Auto refresh every 30 seconds
      setInterval(() => {
        loadChannelList();
        updateStats();
      }, 30000);
      
      // Î≥ÄÍ≤Ω: GSAP Ïï†ÎãàÎ©îÏù¥ÏÖò Ï∂îÍ∞Ä
      initAnimations();
    });
    
    // Î≥ÄÍ≤Ω: Ïï†ÎãàÎ©îÏù¥ÏÖò Ï¥àÍ∏∞Ìôî
    function initAnimations() {
      // Hero animation
      gsap.timeline()
        .to('.cm-hero-title', {opacity: 1, y: 0, duration: 1, delay: 0.5})
        .to('.cm-objects', {opacity: 1, duration: 1}, '-=0.5');
      
      // Scroll animations
      gsap.registerPlugin(ScrollTrigger);
      
      // Section titles
      gsap.utils.toArray('.cm-section-title').forEach(el => {
        gsap.to(el, {
          opacity: 1,
          y: 0,
          duration: 0.8,
          scrollTrigger: {
            trigger: el,
            start: 'top 80%',
            once: true
          }
        });
      });
      
      // Stats cards
      gsap.utils.toArray('.stat-card').forEach((el, i) => {
        gsap.to(el, {
          opacity: 1,
          y: 0,
          duration: 0.8,
          delay: i * 0.1,
          scrollTrigger: {
            trigger: '.stats-dashboard',
            start: 'top 70%',
            once: true
          }
        });
      });
      
      // Create section
      gsap.to('.create-section', {
        opacity: 1,
        y: 0,
        duration: 0.8,
        scrollTrigger: {
          trigger: '.create-section',
          start: 'top 70%',
          once: true
        }
      });
      
      // Channel list
      gsap.to('.channel-list', {
        opacity: 1,
        y: 0,
        duration: 0.8,
        scrollTrigger: {
          trigger: '.channel-list',
          start: 'top 70%',
          once: true
        }
      });
      
      // Header scroll effect
      window.addEventListener('scroll', () => {
        const header = document.getElementById('header');
        if (window.scrollY > 100) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      });
    }
    
    // Logout
    function logout() {
      const token = localStorage.getItem('adminToken');
      if (token) {
        fetch(`${API_BASE_URL}/api/admin/logout`, {
          method: 'POST',
          headers: authHeaders()
        });
      }
      localStorage.removeItem('adminToken');
      localStorage.removeItem('adminRole');
      window.location.href = 'index.html';
    }
    
    // Show stats (placeholder)
    function showStats() {
      showToast('ÌÜµÍ≥Ñ ÌéòÏù¥ÏßÄ Ï§ÄÎπÑÏ§ëÏûÖÎãàÎã§', 'info');
    }
    
    // Update statistics
    function updateStats() {
      const today = new Date().toDateString();
      const todayChannels = channels.filter(ch => 
        new Date(ch.createdAt).toDateString() === today
      ).length;
      
      document.getElementById('totalChannels').textContent = channels.length;
      document.getElementById('totalUsers').textContent = channels.reduce((sum, ch) => sum + (ch.activeUsers || 0), 0);
      document.getElementById('todayChannels').textContent = todayChannels;
      
      // TODO: Ïã§Ï†ú ÌèâÍ∑† ÏÇ¨Ïö©ÏãúÍ∞Ñ Í≥ÑÏÇ∞ Î°úÏßÅ Íµ¨ÌòÑ ÌïÑÏöî (ÌòÑÏû¨Îäî mock Îç∞Ïù¥ÌÑ∞)
      // Ïòà: Í∞Å Ï±ÑÎÑêÏùò createdAtÍ≥º ÌòÑÏû¨ ÏãúÍ∞Ñ Ï∞®Ïù¥Î•º Í≥ÑÏÇ∞ÌïòÏó¨ ÌèâÍ∑† ÏÇ∞Ï∂ú
      document.getElementById('avgDuration').textContent = Math.floor(Math.random() * 60 + 30);
    }
    
    // Channel type toggle
    document.querySelectorAll('input[name="channelType"]').forEach(radio => {
      radio.addEventListener('change', function() {
        const passkeyField = document.getElementById('passkeyField');
        if (this.value === 'public') {
          passkeyField.style.opacity = '0.5';
          passkeyField.style.pointerEvents = 'none';
          document.getElementById('newPasskey').value = '';
        } else {
          passkeyField.style.opacity = '1';
          passkeyField.style.pointerEvents = 'auto';
          generatePasskey();
        }
      });
    });
    
    // Toggle auto close input
    function toggleAutoCloseInput() {
      const type = document.getElementById('autoCloseType').value;
      const hoursSelect = document.getElementById('autoCloseHours');
      const dateTimeInput = document.getElementById('autoCloseDateTime');
      
      if (type === 'none') {
        hoursSelect.style.display = 'none';
        dateTimeInput.style.display = 'none';
      } else if (type === 'hours') {
        hoursSelect.style.display = 'block';
        dateTimeInput.style.display = 'none';
      } else if (type === 'datetime') {
        hoursSelect.style.display = 'none';
        dateTimeInput.style.display = 'block';
        
        // Set minimum datetime to now
        const now = new Date();
        now.setMinutes(now.getMinutes() + 30); // Minimum 30 minutes from now
        dateTimeInput.min = now.toISOString().slice(0, 16);
        if (!dateTimeInput.value) {
          dateTimeInput.value = now.toISOString().slice(0, 16);
        }
      }
    }
    
    // Export all subtitles
    async function exportAllSubtitles() {
      const subtitlesData = {};
      
      // Collect subtitle data for each channel
      for (const channel of channels) {
        // TODO: Ïã§Ï†ú ÏÑúÎ≤ÑÏóêÏÑú ÏûêÎßâ Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
        // const response = await fetch(`${API_BASE_URL}/api/channel/${channel.code}/subtitles`, {
        //   headers: authHeaders()
        // });
        // const data = await response.json();
        
        subtitlesData[channel.code] = {
          channelCode: channel.code,
          eventName: channel.eventName || 'Untitled',
          createdAt: channel.createdAt,
          subtitles: channel.accumulatedText || '[ÏûêÎßâ Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå]'
        };
      }
      
      const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
      const blob = new Blob([JSON.stringify(subtitlesData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `all_subtitles_${timestamp}.json`;
      a.click();
      
      showToast('Ï†ÑÏ≤¥ ÏûêÎßâÏù¥ ÎÇ¥Î≥¥ÎÇ¥Ï°åÏäµÎãàÎã§', 'success');
    }
    
    // Generate random channel code
    function generateChannelCode() {
      const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let code = '';
      for (let i = 0; i < 6; i++) {
        code += characters.charAt(Math.floor(Math.random() * characters.length));
      }
      document.getElementById('newChannelCode').value = code;
      animateInput('newChannelCode');
    }
    
    // Generate random passkey
    function generatePasskey() {
      const passkey = Math.floor(1000 + Math.random() * 9000).toString();
      document.getElementById('newPasskey').value = passkey;
      animateInput('newPasskey');
    }
    
    // Input animation
    function animateInput(inputId) {
      const input = document.getElementById(inputId);
      gsap.to(input, {
        scale: 1.05,
        duration: 0.2,
        onComplete: () => {
          gsap.to(input, {scale: 1, duration: 0.2});
        }
      });
    }
    
    // Create channel
    async function createChannel(event) {
      event.preventDefault();
      
      const createBtn = document.getElementById('createBtn');
      const originalText = createBtn.textContent;
      createBtn.disabled = true;
      createBtn.innerHTML = '<span class="loading" style="width: 16px; height: 16px;"></span>';
      
      // Get auto close settings
      let autoCloseValue = null;
      const autoCloseType = document.getElementById('autoCloseType').value;
      
      if (autoCloseType === 'hours') {
        autoCloseValue = {
          type: 'hours',
          value: parseInt(document.getElementById('autoCloseHours').value)
        };
      } else if (autoCloseType === 'datetime') {
        autoCloseValue = {
          type: 'datetime',
          value: document.getElementById('autoCloseDateTime').value
        };
      }
      
      const channelData = {
        code: document.getElementById('newChannelCode').value,
        type: document.querySelector('input[name="channelType"]:checked').value,
        passkey: document.getElementById('newPasskey').value || null,
        eventDateTime: document.getElementById('eventDateTime').value || null,
        eventName: document.getElementById('eventName').value || null,
        autoClose: autoCloseValue
      };
      
      try {
        const response = await fetch(`${API_BASE_URL}/api/channel/create`, {
          method: 'POST',
          headers: authHeaders(),
          body: JSON.stringify(channelData)
        });
        
        const result = await response.json();
        
        if (response.ok) {
          showToast(`Ï±ÑÎÑê ${channelData.code}Í∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§`, 'success');
          document.querySelector('.create-form').reset();
          document.getElementById('typeSecured').checked = true;
          document.getElementById('autoCloseType').value = 'hours';
          document.getElementById('autoCloseHours').value = '2';
          toggleAutoCloseInput();
          generatePasskey();
          await loadChannelList();
          
          // Show URLs immediately
          showChannelModal(channelData.code);
        } else {
          showToast(result.error || 'Ï±ÑÎÑê ÏÉùÏÑ± Ïã§Ìå®', 'error');
        }
      } catch (error) {
        console.error('Error:', error);
        showToast('ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïã§Ìå®', 'error');
      } finally {
        createBtn.disabled = false;
        createBtn.textContent = originalText;
      }
    }
    
    // Load channel list
    async function loadChannelList() {
      try {
        const response = await fetch(`${API_BASE_URL}/api/channels`, {
          headers: authHeaders()
        });
        
        if (!response.ok) {
          throw new Error('Failed to fetch channels');
        }
        
        channels = await response.json();
        const tbody = document.getElementById('channelTableBody');
        
        if (channels.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="7" style="text-align: center; padding: 2rem; color: #888;">
                No channels created yet
              </td>
            </tr>
          `;
          return;
        }
        
        tbody.innerHTML = channels.map(ch => {
          const createdDate = new Date(ch.createdAt);
          const now = new Date();
          const duration = Math.floor((now - createdDate) / 60000); // minutes
          
          return `
            <tr>
              <td>
                <span class="channel-code" onclick="showChannelModal('${ch.code}')">${ch.code}</span>
              </td>
              <td><span class="badge ${ch.type}" id="type-${ch.code}">${ch.type === 'public' ? 'Í≥µÍ∞ú' : 'ÎπÑÍ≥µÍ∞ú'}</span></td>
              <td><span id="passkey-${ch.code}">${ch.passkey ? `<span class="passkey">${ch.passkey}</span>` : '-'}</span></td>
              <td>
                <div class="active-count">
                  ${ch.activeUsers > 0 ? '<span class="count-dot"></span>' : ''}
                  <span>${ch.activeUsers || 0}</span>
                </div>
              </td>
              <td>
                <span style="color: ${duration < 60 ? '#4ecdc4' : duration < 180 ? '#f0c674' : '#e06c75'}">
                  ${duration < 60 ? 'ÌôúÏÑ±' : duration < 180 ? 'ÏßÑÌñâÏ§ë' : 'Ïû•ÏãúÍ∞Ñ'}
                </span>
              </td>
              <td>${createdDate.toLocaleString('ko-KR', { 
                month: '2-digit', 
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
              })}</td>
              <td>
                <div class="actions">
                  <button class="btn-small manage" onclick="showChannelModal('${ch.code}')">Í¥ÄÎ¶¨</button>
                  <button class="btn-small copy" onclick="copyChannelURL('${ch.code}')">URLÎ≥µÏÇ¨</button>
                  <button class="btn-small delete" onclick="deleteChannel('${ch.code}')">ÏÇ≠Ï†ú</button>
                </div>
              </td>
            </tr>
          `;
        }).join('');
        
        updateStats();
      } catch (error) {
        console.error('Error loading channels:', error);
        const tbody = document.getElementById('channelTableBody');
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; padding: 2rem; color: #e06c75;">
              Failed to load channels. Please check your connection.
            </td>
          </tr>
        `;
      }
    }
    
    // Show channel modal
    function showChannelModal(code) {
      const channel = channels.find(ch => ch.code === code);
      if (!channel) return;
      
      currentModalChannel = channel;
      
      document.getElementById('modalChannelCode').textContent = code;
      document.getElementById('viewerURL').value = `${window.location.origin}/viewer.html?channel=${code}`;
      document.getElementById('stenoURL').value = `${window.location.origin}/editor.html?channel=${code}`;
      
      document.getElementById('modalViewers').textContent = `${channel.activeUsers || 0}Î™Ö`;
      document.getElementById('modalCreated').textContent = new Date(channel.createdAt).toLocaleString('ko-KR');
      
      const duration = Math.floor((new Date() - new Date(channel.createdAt)) / 60000);
      document.getElementById('modalDuration').textContent = `${duration}Î∂Ñ`;
      
      // Display auto close information
      let autoCloseText = 'ÏÑ§Ï†ï ÏïàÌï®';
      if (channel.autoClose) {
        if (channel.autoClose.type === 'hours') {
          autoCloseText = `${channel.autoClose.value}ÏãúÍ∞Ñ ÌõÑ`;
        } else if (channel.autoClose.type === 'datetime') {
          const closeDate = new Date(channel.autoClose.value);
          autoCloseText = closeDate.toLocaleString('ko-KR');
        }
      }
      document.getElementById('modalAutoClose').textContent = autoCloseText;
      
      // Update type toggle buttons
      if (channel.type === 'public') {
        document.getElementById('publicToggle').classList.add('active');
        document.getElementById('securedToggle').classList.remove('active');
        document.getElementById('passkeySection').style.display = 'none';
      } else {
        document.getElementById('publicToggle').classList.remove('active');
        document.getElementById('securedToggle').classList.add('active');
        document.getElementById('passkeySection').style.display = 'block';
      }
      
      document.getElementById('channelModal').classList.add('show');
    }
    
    // Change channel type
    async function changeChannelType(newType) {
      if (!currentModalChannel) return;
      
      const oldType = currentModalChannel.type;
      if (oldType === newType) {
        showToast('Ïù¥ÎØ∏ Ìï¥Îãπ ÌÉÄÏûÖÏûÖÎãàÎã§', 'info');
        return;
      }
      
      // Í≥µÍ∞ú‚ÜíÎπÑÍ≥µÍ∞ú Ï†ÑÌôòÏù¥Î©¥ ÏÉà Ìå®Ïä§ÌÇ§ ÎØ∏Î¶¨ Ï§ÄÎπÑ
      let newPasskey = null;
      if (newType === 'secured') {
        newPasskey = Math.floor(1000 + Math.random() * 9000).toString();
      }
      
      try {
        // 1) ÏÑúÎ≤ÑÏóê ÌÉÄÏûÖÍ≥º Ìå®Ïä§ÌÇ§ Ìï®Íªò Î∞òÏòÅ
        const res = await fetch(`${API_BASE_URL}/api/channel/${currentModalChannel.code}/type`, {
          method: 'PATCH',
          headers: authHeaders(),
          body: JSON.stringify({ 
            type: newType, 
            passkey: newPasskey  // ÌÉÄÏûÖÍ≥º Ìå®Ïä§ÌÇ§ Ìï®Íªò Ï†ÑÏÜ°
          })
        });
        
        if (!res.ok) {
          const error = await res.json();
          throw new Error(error.message || 'ÌÉÄÏûÖ Î≥ÄÍ≤Ω Ïã§Ìå®');
        }
        
        // 2) Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
        currentModalChannel.type = newType;
        currentModalChannel.passkey = newPasskey;
        
        if (newType === 'public') {
          document.getElementById('publicToggle').classList.add('active');
          document.getElementById('securedToggle').classList.remove('active');
          document.getElementById('passkeySection').style.display = 'none';
        } else {
          document.getElementById('publicToggle').classList.remove('active');
          document.getElementById('securedToggle').classList.add('active');
          document.getElementById('passkeySection').style.display = 'block';
          document.getElementById('modalNewPasskey').value = '';
        }
        
        // 3) ÌÖåÏù¥Î∏î UI ÏóÖÎç∞Ïù¥Ìä∏
        const typeElement = document.querySelector(`#type-${currentModalChannel.code}`);
        const passkeyElement = document.querySelector(`#passkey-${currentModalChannel.code}`);
        
        if (typeElement) {
          typeElement.className = `badge ${newType}`;
          typeElement.textContent = newType === 'public' ? 'Í≥µÍ∞ú' : 'ÎπÑÍ≥µÍ∞ú';
        }
        
        if (passkeyElement) {
          passkeyElement.innerHTML = currentModalChannel.passkey ? 
            `<span class="passkey">${currentModalChannel.passkey}</span>` : '-';
        }
        
        // 4) channels Î∞∞Ïó¥ ÏóÖÎç∞Ïù¥Ìä∏
        const channelIndex = channels.findIndex(ch => ch.code === currentModalChannel.code);
        if (channelIndex !== -1) {
          channels[channelIndex] = currentModalChannel;
        }
        
        showToast(`Ï±ÑÎÑêÏù¥ ${newType === 'public' ? 'Í≥µÍ∞ú' : 'ÎπÑÍ≥µÍ∞ú'}Î°ú Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§`, 'success');
      } catch (error) {
        showToast(error.message || 'Î≥ÄÍ≤Ω Ïã§Ìå®', 'error');
      }
    }
    
    // Close modal
    function closeModal() {
      document.getElementById('channelModal').classList.remove('show');
      currentModalChannel = null;
    }
    
    // Copy URL - ÏµúÏã† Clipboard API Ïö∞ÏÑ†, fallback Ìè¨Ìï®
    async function copyURL(inputId) {
      const input = document.getElementById(inputId);
      const text = input.value;
      
      try {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(text);
        } else {
          // Fallback for older browsers or non-secure contexts
          input.select();
          document.execCommand('copy');
        }
        showToast('URLÏù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§', 'success');
      } catch (error) {
        showToast('Î≥µÏÇ¨ Ïã§Ìå®', 'error');
      }
    }
    
    // Copy channel URL directly - ÏµúÏã† Clipboard API Ïö∞ÏÑ†, fallback Ìè¨Ìï®
    async function copyChannelURL(code) {
      const url = `${window.location.origin}/viewer.html?channel=${code}`;
      
      try {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(url);
        } else {
          // Fallback: ÏûÑÏãú input ÏÉùÏÑ±
          const tempInput = document.createElement('input');
          tempInput.value = url;
          document.body.appendChild(tempInput);
          tempInput.select();
          document.execCommand('copy');
          document.body.removeChild(tempInput);
        }
        showToast('Î∑∞Ïñ¥ URLÏù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§', 'success');
      } catch (error) {
        showToast('Î≥µÏÇ¨ Ïã§Ìå®', 'error');
      }
    }
    
    // Update passkey
    async function updatePasskey() {
      const newPasskey = document.getElementById('modalNewPasskey').value;
      if (!/^\d{4}$/.test(newPasskey)) {
        showToast('4ÏûêÎ¶¨ Ìå®Ïä§ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî', 'error');
        return;
      }
      
      if (!currentModalChannel) return;
      
      try {
        // 1) ÏÑúÎ≤Ñ Î∞òÏòÅ
        const res = await fetch(`${API_BASE_URL}/api/channel/${currentModalChannel.code}/passkey`, {
          method: 'PATCH',
          headers: authHeaders(),
          body: JSON.stringify({ passkey: newPasskey })
        });
        
        if (!res.ok) {
          const error = await res.json();
          throw new Error(error.message || 'Ìå®Ïä§ÌÇ§ Î≥ÄÍ≤Ω Ïã§Ìå®');
        }
        
        // 2) Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
        currentModalChannel.passkey = newPasskey;
        
        // 3) ÌÖåÏù¥Î∏î UI ÏóÖÎç∞Ïù¥Ìä∏
        const passkeyElement = document.querySelector(`#passkey-${currentModalChannel.code}`);
        if (passkeyElement) {
          passkeyElement.innerHTML = `<span class="passkey">${newPasskey}</span>`;
        }
        
        // 4) channels Î∞∞Ïó¥ ÏóÖÎç∞Ïù¥Ìä∏
        const channelIndex = channels.findIndex(ch => ch.code === currentModalChannel.code);
        if (channelIndex !== -1) {
          channels[channelIndex].passkey = newPasskey;
        }
        
        showToast('Ìå®Ïä§ÌÇ§Í∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§', 'success');
        document.getElementById('modalNewPasskey').value = '';
      } catch (error) {
        showToast(error.message || 'Î≥ÄÍ≤Ω Ïã§Ìå®', 'error');
      }
    }
    
    // Extend channel
    async function extendChannel(hours) {
      if (!currentModalChannel) return;
      
      try {
        const res = await fetch(`${API_BASE_URL}/api/channel/${currentModalChannel.code}/extend`, {
          method: 'POST',
          headers: authHeaders(),
          body: JSON.stringify({ hours })
        });
        
        if (!res.ok) {
          const error = await res.json();
          throw new Error(error.message || 'Ïó∞Ïû• Ïã§Ìå®');
        }
        
        showToast(`Ï±ÑÎÑêÏù¥ ${hours}ÏãúÍ∞Ñ Ïó∞Ïû•ÎêòÏóàÏäµÎãàÎã§`, 'success');
        
        // ÌïÑÏöîÏãú Ï±ÑÎÑê Î™©Î°ù Ïû¨Î°úÎìú
        // await loadChannelList();
      } catch (error) {
        showToast(error.message || 'Ïó∞Ïû• Ïã§Ìå®', 'error');
      }
    }
    
    // Export modal channel subtitles
    function exportModalChannelSubtitles() {
      if (currentModalChannel) {
        exportChannelSubtitles(currentModalChannel.code);
      }
    }
    
    // Export channel data
    async function exportChannelData() {
      if (!currentModalChannel) return;
      
      try {
        // TODO: ÏÑúÎ≤ÑÏóêÏÑú Ï†ÑÏ≤¥ Ï±ÑÎÑê Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
        // const response = await fetch(`${API_BASE_URL}/api/channel/${currentModalChannel.code}/full`, {
        //   headers: authHeaders()
        // });
        // const fullData = await response.json();
        
        const data = {
          channel: currentModalChannel.code,
          type: currentModalChannel.type,
          passkey: currentModalChannel.passkey,
          created: currentModalChannel.createdAt,
          event: currentModalChannel.eventName,
          autoClose: currentModalChannel.autoClose,
          // Ïã§Ï†ú ÏûêÎßâ Îç∞Ïù¥ÌÑ∞Îäî ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ†∏ÏôÄÏïº Ìï®
          // accumulatedText: fullData.accumulatedText
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `channel_${currentModalChannel.code}_${Date.now()}.json`;
        a.click();
        
        showToast('Îç∞Ïù¥ÌÑ∞Í∞Ä ÎÇ¥Î≥¥ÎÇ¥Ï°åÏäµÎãàÎã§', 'success');
      } catch (error) {
        showToast('Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Ïã§Ìå®', 'error');
      }
    }
    
    // Export all data
    function exportAllData() {
      const blob = new Blob([JSON.stringify(channels, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `all_channels_${Date.now()}.json`;
      a.click();
      
      showToast('Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞Í∞Ä ÎÇ¥Î≥¥ÎÇ¥Ï°åÏäµÎãàÎã§', 'success');
    }
    
    // Delete channel
    async function deleteChannel(code) {
      if (confirm(`Ï±ÑÎÑê ${code}Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
        try {
          const response = await fetch(`${API_BASE_URL}/api/channel/${code}`, {
            method: 'DELETE',
            headers: authHeaders()
          });
          
          if (response.ok) {
            showToast('Ï±ÑÎÑêÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§', 'success');
            await loadChannelList();
          } else {
            const result = await response.json();
            showToast(result.error || 'ÏÇ≠Ï†ú Ïã§Ìå®', 'error');
          }
        } catch (error) {
          console.error('Error:', error);
          showToast('ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïã§Ìå®', 'error');
        }
      }
    }
    
    // Delete channel from modal
    function deleteChannelFromModal() {
      if (currentModalChannel) {
        deleteChannel(currentModalChannel.code);
        closeModal();
      }
    }
    
    // Search channels
    function searchChannels(query) {
      const rows = document.querySelectorAll('#channelTableBody tr');
      query = query.toLowerCase();
      
      rows.forEach(row => {
        const channelCodeElement = row.querySelector('.channel-code');
        if (channelCodeElement) {
          const text = row.textContent.toLowerCase();
          row.style.display = text.includes(query) ? '' : 'none';
        }
      });
    }
    
    // Show toast notification
    function showToast(message, type = 'info') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type}`;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
    
    // Auto-format inputs
    document.getElementById('newChannelCode').addEventListener('input', function(e) {
      e.target.value = e.target.value.toUpperCase();
    });
    
    document.getElementById('newPasskey').addEventListener('input', function(e) {
      e.target.value = e.target.value.replace(/[^0-9]/g, '');
    });
    
    document.getElementById('modalNewPasskey').addEventListener('input', function(e) {
      e.target.value = e.target.value.replace(/[^0-9]/g, '');
    });
    
    // Initialize
    generatePasskey();
  </script>
</body>
</html>
